---
title: How does human activity affect the movement patterns of wild animals?
subtitle: An analysis of selected datasets from the Movebank animal tracking database
author: Jannis Bolzern and Elke Michlmayr
format:
  html:
    code-fold: true
execute:
  warning: false
  message: false
lang: en
bibliography: bibliography.bib
---

```{r preprocessing}
#| code-summary: preprocessing
``` 

## Abstract

In this project, we aim to investigate how human activity influences the movement patterns of wild animals. Using GPS and Argos tracking data from red foxes, bobcats, and coyotes across rural and remote areas in England, Canada, and the US, we will analyze home range sizes, temporal activity shifts, and habitat selection in relation to human footprint and land use data.

## Introduction

Research questions:

1. **Access to Anthropogenic Food Sources:** Do animals in high human-impact areas exhibit smaller home ranges due to easier access to food resources?
2. **Temporal Shifts in Activity Patterns:** Do animals become more nocturnal in high human-impact areas to avoid direct human encounters?
3. **Habitat Selection in Human-Dominated Landscapes:** How do animals select habitats (e.g., forests, agriculture) under varying levels of human influence?

Additional challenges:

* We will be using data for purposes that it wasn't originally collected for.
* We will be comparing between data from different studies (foxes).
* We will be using parts of datasets (missing animals in the bobcat/coyote study).

## Material and Methods

### Datasets

We will use the following wild animal tracking data published on Movebank under a Creative Commons license by three different research groups (see references):

* **Red fox** data from @porteus2024movement for rural areas (outskirt areas of villages in Wiltshire, UK) will be compared to red fox data from @lai2022red for remote areas (uninhabitated islands Bylot and Herschel, Canada)
* **Bobcat** and **coyote** data from @prugh2023fear for remote areas with some rural structures (GPS-based, northern Washington, US)

For the human footprint data, we will use the **global 100 meter resolution terrestrial human footprint data (HFP-100)** by @gassert2023operational. The data can be read in Python, R, or any other script that has libraries that can interpret geospatial data (such as folium).

If required, for **land use** in Washington, US, we will rely on the General Land Use Final Dataset published by Washington Spatial Data ([link](https://geo.wa.gov/datasets/a0ddbd4e0e2141b3841a6a42ff5aff46_0/explore?location=48.347066%2C-118.420235%2C9.91)) and for land use in the UK on gov.uk data ([link](https://www.data.gov.uk/dataset/946ce540-de76-441e-bac8-624f30cace8a/land-cover-map-2021-10m-classified-pixels-gb)).

### Data preparation and processing

#### Movebank
We have used data from the Movebank database and system by @kays2022movebank. This simplifies data preparation since all the datasets have the same format and table definitions. A library for data ingestion and trajectory handling in R is provided by @bartk_move2.

```{r}
library("dplyr")
library("move2")
library("units")
library("rnaturalearth")

foxes_wiltshire <- movebank_download_study(
  study_id = 3179890710,
  sensor_type_id = c("gps"),
  'license-md5'='ffa36f79defe10eac9fe70f6502a17e0'
)
foxes_bylot <- movebank_download_study(
  study_id = 1371322147,
  'license-md5'='9559cb1b1cca51e9f3fd69812e5e22dc'
)
foxes_herschel <- movebank_download_study(
  study_id = 1371529289,
  'license-md5'='436e8205d0c2973115e2024b146a6ad5'
)
```

@laube2011 have found that the temporal scale affects the calculation of movement parameters. The speed, sinuosity and turning angle of animal trajectories will differ based on the sampling interval. We conclude that temporal scale could also affect home range results.

Therefore we need to check if the sampling intervals are similar between the datasets to ensure an apples-to-apples comparison. We also need to make sure that the datasets cover comparable time ranges.

The Wiltshire data was collected at 10 or 60 minute intervals. The research team had the option to select the sampling interval remotely. They used this to save battery at times the data was considered less interesting, such as times when foxes were known to be usually static. The Canadian data was collected just once per day, at randomly different afternoon times of the day. 

This poses an interesting challenge because it would not be reasonable to assume that foxes in remote area will follow the same daily patterns as the ones living in a rural area. These two groups will have different activity levels because in one case humans will be present in the afternoon and in the other case that will not happen.

When doing processing, be careful since the places are in different timezones.

```{r}
#| label: red fox data filtering
# TBD: filter data to the same time range (doesnt have to be the same year, but same month and day)

foxes_wiltshire |>
  group_by(timestamp())


```

#### HRP-100

Use 2020 data and make a subset as quickly as possible

### Methodology

#### Trajectory Analysis:
Movement paths will be analyzed to identify patterns in speed, direction, and habitat use. Step lengths and turning angles will help infer behavioral states. Step-selection functions (SSFs) will model habitat preferences relative to availability, allowing us to quantify how animals respond to environmental covariates such as human footprint and land use.

#### Home Range Assessment:
Home range sizes will be calculated using kernel density estimation (KDE) and minimum convex polygons (MCPs). This will provide estimates of the area used by each individual. Home ranges will be compared across regions with varying levels of human activity to test whether access to anthropogenic food sources (e.g., garbage, crops) leads to smaller home ranges due to resource concentration.

TBD: There are several ways to calculate home range, we could compare (and could focus on only that)

TBD: Do this for foxes first, for bobcat and coyote data later, potentially even cross-species analysis


```{r}
library("ggplot2")
library("sf")

tracks = mt_track_lines(foxes_wiltshire)
mcp <- st_convex_hull(tracks)
area <- st_area(mcp)
print(area)
ggplot(mcp, aes(fill = individual_id)) +
  geom_sf(alpha = 0.4)

#c1_tracks = mt_track_lines(foxes_bylot)
#c1_mcp <- st_convex_hull(c1_tracks)
#print(c1_area)
#c1_area <- st_area(c1_mcp)
#ggplot(c1_mcp, aes(fill = individual_id)) +
#  geom_sf(alpha = 0.4)

#c2_tracks = mt_track_lines(foxes_herschel)
#c2_mcp <- st_convex_hull(c2_tracks)
#c2_area <- st_area(c2_mcp)
#print(c2_area)
#ggplot(c2_mcp, aes(fill = individual_id)) +
#  geom_sf(alpha = 0.4)
```

#### Temporal Activity Patterns:
Movement rates will be used to quantify diel activity shifts. We will test whether animals in high human-impact areas exhibit increased nocturnality, potentially as a strategy to avoid direct human encounters. This analysis will reveal how temporal behavior adapts to human presence.

#### Habitat Selection:
SSFs will quantify selection for human-modified habitats (e.g., agricultural areas, urban edges) relative to natural habitats. By comparing selection patterns across species and regions, we will assess how habitat preferences vary with human influence.

## Results

## Discussion

* Wortlimit mit Patrick besprechen
* Runder Bericht in dem die research questions zu Ende beantwortet werden

## Appendix

### Wordcount

<!-- after installing the wordcountadding (see https://github.com/benmarwick/wordcountaddin), remove the line "#| eval: false" -->

```{r}
wordcountaddin::word_count("index.qmd")
```

### Use of Large Language Models and Generative AI

Elke used @notebooklm for interactively querying the set of research papers cited in the references.

